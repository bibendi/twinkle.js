version: '2'

compose:
  files:
    - docker-compose.yml

interaction:
  bash:
    service: app
    command: bash

  yarn:
    service: app
    command: yarn
    subcommands:
      start:
        compose_method: up
        compose_run_options: [detach]
      dev:
        command: yarn dev
        compose_run_options: [service-ports, use-aliases]
      debug:
        command: yarn debug
        compose_run_options: [service-ports, use-aliases]

  psql:
    service: postgres
    command: psql -h postgres -U postgres

provision:
  - dip yarn install
  - dip yarn sequelize-cli db:create
  - dip yarn sequelize-cli db:migrate
